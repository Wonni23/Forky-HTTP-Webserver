# Nginx 클론 테스트 설정 파일
http {
    client_max_body_size 100M;
    error_page /error.html;
    
    # 첫 번째 서버 (기본 서버)
    server {
        listen 192.168.1.100:8080 default_server;
        server_name example.com;
        client_max_body_size 2000M;
        
        # 관리자 페이지 - GET, HEAD만 허용
        location /admin/ {
            root /var/www/admin;
            index admin.html;
            autoindex off;
            limit_except GET HEAD { 
                deny all;
            }
        }
        
        # 리다이렉트 예시
        location /old-page {
            return 301 http://example.com/new-page;
        }
        
        # 정적 파일 서빙
        location /static/ {
            root /usr/share/nginx;
            autoindex on;
            index index.html;
        }
        
        # CGI 처리
        location /cgi-bin/ {
            root /usr/lib/cgi-bin;
            cgi_pass unix:/var/run/fcgiwrap.socket;
            limit_except GET POST {
                deny all;
            }
            client_max_body_size 50M;
            autoindex off;
        }
        
        # 파일 업로드
        location /uploads/ {
            root /src/uploads;
            client_max_body_size 1000M;
            autoindex 0;
            limit_except POST PUT {
                deny all;
            }
        }
        
        # 에러 페이지
        location /error.html {
            root /usr/share/nginx/html;
        }
    }
    
    # 두 번째 서버 (다른 포트)
    server {
        listen 80;
        server_name localhost;
        
        location / {
            root /var/www/html;
            index index.html;
            autoindex on;
        }
        
        location /api/ {
            root /var/www/api;
            autoindex off;
            limit_except GET POST PUT DELETE {
                deny all;
            }
        }
    }
}