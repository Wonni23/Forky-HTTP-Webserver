# Nginx 클론 테스트 설정 파일
http {
    client_max_body_size 100M;
    error_page 500 502 503 /error.html;
    error_page 400 401 /4xx_http.html;

    # Tester Server Configuration
    server {
        listen 8080 default_server;
        server_name localhost;
        client_max_body_size 2000M;
        error_page 500 /server_500.html;
        error_page 404 405 /4xx.html;

        # 1. Root location - GET only (HEAD automatically allowed per RFC 2616)
        location / {
            root /home/donjung/Forky-Webserv/YoupiBanane;
            index youpi.bad_extension;
            autoindex off;
            limit_except GET {
                deny all;
            }
        }

        # 2. PUT test - PUT requests to save files
        location /put_test/ {
            root /home/donjung/Forky-Webserv;
            limit_except PUT {
                deny all;
            }
            client_max_body_size 1000M;
            autoindex off;
        }

        # 3. .bla extension files - POST with cgi_test executable
        # Note: Since we don't support regex, we create location for each .bla file
        location /directory/youpi.bla {
            root /home/donjung/Forky-Webserv/YoupiBanane;
            cgi_pass /home/donjung/Forky-Webserv/ubuntu_cgi_tester;
            limit_except POST {
                deny all;
            }
        }

        # 4. POST body - maxBody 100 bytes
        location /post_body {
            root /home/donjung/Forky-Webserv/YoupiBanane;
            client_max_body_size 100;
            limit_except POST {
                deny all;
            }
        }

        # 5. Directory listing - YoupiBanane with youpi.bad_extension as index
        location /directory/ {
            alias /home/donjung/Forky-Webserv/YoupiBanane/;
            index youpi.bad_extension;
            autoindex off;
            limit_except GET {
                deny all;
            }
        }
    }
    
}