# Nginx 클론 테스트 설정 파일
http {
    client_max_body_size 100M;
    error_page 500 502 503 /error.html;
    error_page 400 401 /4xx_http.html;

    # 첫 번째 서버 (기본 서버)
    server {
        listen 10.11.11.6:8080 default_server;
        server_name example.com;
        client_max_body_size 2000M;
        error_page 500 /server_500.html;
        error_page 404 405 /4xx.html;
        
        # 관리자 페이지 - GET, HEAD만 허용
        location /admin/ {
            root /var/www/admin;
            index admin.html;
            autoindex off;
            limit_except GET HEAD { 
                deny all;
            }
        }
        
        # 리다이렉트 예시
        location /old-page {
            return 301 http://example.com/new-page;
        }
        
        # 정적 파일 서빙
        location /static/ {
            root /usr/share/nginx;
            autoindex on;
            index index.html;
        }

        # 이미지 파일 - alias 사용 (URL 경로를 실제 경로로 대체)
        location /images/ {
            alias /data/pictures/;
            autoindex on;
        }

        # CGI 처리
        location /cgi-bin/ {
            root /usr/lib/cgi-bin;
            cgi_pass unix:/var/run/fcgiwrap.socket;
            limit_except GET POST {
                deny all;
            }
            client_max_body_size 50M;
            autoindex off;
            error_page 500 501 /5xx.html;
            error_page 502 503 /5xx_gateway.html;
        }
        
        # 파일 업로드
        location /uploads/ {
            root /src/uploads;
            client_max_body_size 1000M;
            autoindex 0;
            limit_except POST PUT {
                deny all;
            }
        }
        
        # 에러 페이지
        location /error.html {
            root /usr/share/nginx/html;
        }
    }
    
    # 두 번째 서버 (다른 포트)
    server {
        listen 8081;
        server_name localhost;
        
        location / {
            root /var/www/html;
            index index.html;
            autoindex on;
        }
        
        location /api/ {
            root /var/www/api;
            autoindex off;
            limit_except GET POST PUT DELETE {
                deny all;
            }
        }
    }
}